/**
 * Requiem
 * (c) VARIANTE (http://variante.io)
 *
 * This software is released under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 */

/**
 * Selector for elements with the r-controller attribute.
 *
 * @param {String} $name r-controller attribute value.
 */
@mixin controller($name)
{
  [data-r-controller='#{$name}'] { @content; }
  [r-controller='#{name}']       { @content; }
}

/**
 * Selector for elements with the r-instance attribute.
 *
 * @param {String} $name r-instance attribute value.
 */
@mixin instance($name)
{
  [data-r-instance='#{$name}'] { @content; }
  [r-instance='#{name}']       { @content; }
}

/**
 * Selects elements with the specified r-property key and value.
 *
 * @param {String} $key    r-property key.
 * @param {String} $value  r-property value, if applicable.
 * @param {String} $scope  Specifies the scope relative to the target selector
 *                        in which this property applies to (any, this, parent,
 *                        or child).
 */
@mixin property($key, $value:null, $scope:'this') {
  @if $value == null {
    @if $scope == 'any' {
      @at-root [data-r-property-#{$key}] { @content; }
      @at-root [r-property-#{key}]       { @content; }
    }
    @else if $scope == 'this' {
      &[data-r-property-#{$key}] { @content; }
      &[r-property-#{key}]       { @content; }
    }
    @else if $scope == 'parent' {
      [data-r-property-#{$key}] & { @content; }
      [r-property-#{key}] &       { @content; }
    }
    @else if $scope == 'child' {
      &[data-r-property-#{$key}] * { @content; }
      &[r-property-#{key}] *      { @content; }
    }
  }
  @else {
    @if $scope == 'any' {
      @at-root [data-r-property-#{$key}='#{$value}'] { @content; }
      @at-root [r-property-#{key}='#{value}']        { @content; }
    }
    @else if $scope == 'this' {
      &[data-r-property-#{$key}='#{$value}'] { @content; }
      &[r-property-#{key}='#{value}']        { @content; }
    }
    @else if $scope == 'parent' {
      [data-r-property-#{$key}='#{$value}'] & { @content; }
      [r-property-#{key}='#{value}'] &        { @content; }
    }
    @else if $scope == 'child' {
      &[data-r-property-#{$key}='#{$value}'] * { @content; }
      &[r-property-#{key}='#{value}'] *       { @content; }
    }
  }
}

/**
 * Binds the content to one/multiple r-states of the target selector. Option to
 * specify whether the state(s) are default.
 *
 * @param {List}    $states   List of state names.
 * @param {Boolean} $default  Specifies whether the class(es) are default.
 */
@mixin state($states, $default:false) {
  @each $state in $states {
    @if $state == 'hover' {
      @if $modernizr-enabled == true {
        .no-touch &:hover { @content; }
        .no-touch &[data-r-state='hover'] { @content; }
        .no-touch &[r-state='hover']      { @content; }
      }
      @else {
        &:hover { @content; }
        &[data-r-state='hover'] { @content; }
        &[r-state='hover']      { @content; }
      }
    }
    @else {
      &[data-r-state='#{$state}'] { @content; }
      &[r-state='#{$state}']      { @content; }
    }
  }

  @if $default == true {
    @content;
  }
}

/**
 * Binds the content to a r-style of the target selector. Option to specify
 * whether the style is default.
 *
 * @param {String}  $style    Style name.
 * @param {Boolean} $default  Specifies whether the class(es) are default.
 * @param {String}  $scope    Specifies the scope relative to the target
 *                           selector in which this property applies to (any,
 *                           this, parent, or child).
 */
@mixin style($style, $default:false, $scope:'this') {
  @if $scope == 'any' {
    @at-root [data-r-style='#{$style}'] { @content; }
    @at-root [r-style='#{$style}'] { @content; }

    @if $default == true {
      @at-root * { @content; }
    }
  }
  @else if $scope == 'this' {
    &[data-r-style='#{$style}'] { @content; }
    &[r-style='#{$style}']      { @content; }

    @if $default == true {
        @content;
    }
  }
  @else if $scope == 'parent' {
    [data-r-style='#{$style}'] & { @content; }
    [r-style='#{$style}'] &      { @content; }

    @if $default == true {
      @content;
    }
  }
  @else if $scope == 'child' {
    &[data-r-style='#{$style}'] * { @content; }
    &[r-style='#{$style}'] *     { @content; }

    @if $default == true {
      & * {
        @content;
      }
    }
  }
}
